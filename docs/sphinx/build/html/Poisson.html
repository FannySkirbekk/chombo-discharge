

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Poisson &mdash; PlasmaC 19.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Radiative transfer" href="RTE.html" />
    <link rel="prev" title="Convection-Diffusion-Reaction" href="CDR.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PlasmaC
          

          
          </a>

          
            
            
              <div class="version">
                19.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">PlasmaC introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Model.html">The <code class="docutils literal notranslate"><span class="pre">PlasmaC</span></code> code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basics.html">Chombo basics</a></li>
</ul>
<p class="caption"><span class="caption-text">Using PlasmaC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Realm.html">Realm</a></li>
<li class="toctree-l1"><a class="reference internal" href="MeshData.html">Understanding mesh data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticleData.html">Understanding particle data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Control.html">Controlling <code class="docutils literal notranslate"><span class="pre">PlasmaC</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualization.html">Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">PlasmaC design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Driver.html">driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="AmrMesh.html">amr_mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="ComputationalGeometry.html">computational_geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeStepper.html">time_stepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="CellTagger.html">cell_tagger</a></li>
</ul>
<p class="caption"><span class="caption-text">Supported solvers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Solver.html">Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="CDR.html">Convection-Diffusion-Reaction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Poisson</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-the-solver">Setting up the solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tuning-multigrid-performance">Tuning multigrid performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adjusting-output">Adjusting output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="RTE.html">Radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sigma.html">Surface charge solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ito.html">Îto diffusion</a></li>
</ul>
<p class="caption"><span class="caption-text">Implemented models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="PoissonModel.html">Poisson model</a></li>
<li class="toctree-l1"><a class="reference internal" href="AdvectionDiffusionModel.html">Advection diffusion model</a></li>
<li class="toctree-l1"><a class="reference internal" href="BrownianWalkerModel.html">Brownian walker model</a></li>
<li class="toctree-l1"><a class="reference internal" href="MinimalPlasmaModel.html">Minimal plasma model</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Tutorial.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial.html#setting-up-time-stepper">Setting up <code class="docutils literal notranslate"><span class="pre">time_stepper</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="References.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PlasmaC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Poisson</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Poisson.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="poisson">
<span id="chap-poissonsolver"></span><h1>Poisson<a class="headerlink" href="#poisson" title="Permalink to this headline">¶</a></h1>
<p>The code for the Poisson solver is given in <code class="file docutils literal notranslate"><span class="pre">/src/poisson</span></code> <em>and</em> <code class="file docutils literal notranslate"><span class="pre">/src/elliptic</span></code>.
The first folder contains the interface and code for only the Poisson solver, whereas the <code class="file docutils literal notranslate"><span class="pre">/src/elliptic</span></code> folder also contains generic code for elliptic problems.</p>
<p>The Poisson solver is named <code class="docutils literal notranslate"><span class="pre">poisson_solver</span></code> and currently only has one specific implementation: <code class="docutils literal notranslate"><span class="pre">poisson_multifluid_gmg</span></code> which uses a multifluid embedded boundary formulation together with geometric multigrid.</p>
<div class="section" id="setting-up-the-solver">
<h2>Setting up the solver<a class="headerlink" href="#setting-up-the-solver" title="Permalink to this headline">¶</a></h2>
<p>In order to set up the solver, one must provide the</p>
<p>Creating a solver is often done with smart pointer casts like so:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">poisson_solver</span><span class="o">&gt;</span> <span class="n">poisson</span> <span class="o">=</span> <span class="n">RefCountedPtr</span><span class="o">&lt;</span><span class="n">poisson_solver</span><span class="o">&gt;</span> <span class="p">(</span><span class="k">new</span> <span class="n">poisson_multifluid_gmg</span><span class="p">());</span>
</pre></div>
</div>
<p>In addition, one must parse run-time options to the class, provide the <code class="docutils literal notranslate"><span class="pre">amr_mesh</span></code> and <code class="docutils literal notranslate"><span class="pre">computational_geometry</span></code> instances, and set the initial conditions.
This is done as follows:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">poisson</span><span class="o">-&gt;</span><span class="n">parse_options</span><span class="p">();</span>              <span class="c1">// Parse class options</span>
<span class="n">poisson</span><span class="o">-&gt;</span><span class="n">set_amr</span><span class="p">(</span><span class="n">amr</span><span class="p">);</span>                 <span class="c1">// Set amr - we assume that `amr` is an object</span>
<span class="n">poisson</span><span class="o">-&gt;</span><span class="n">set_computational_geometry</span><span class="p">();</span> <span class="c1">// Set the computational geometry</span>
<span class="n">poisson</span><span class="o">-&gt;</span><span class="n">allocate_internals</span><span class="p">();</span>         <span class="c1">// Allocate storage for potential etc.</span>
<span class="n">poisson</span><span class="o">-&gt;</span><span class="n">set_potential</span><span class="p">(</span><span class="n">potential</span><span class="p">);</span>     <span class="c1">// Set the potential</span>
</pre></div>
</div>
<p>The argument in the function <code class="docutils literal notranslate"><span class="pre">set_potential(...)</span></code> is a function pointer of the type</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Real</span> <span class="n">potential</span><span class="p">(</span><span class="k">const</span> <span class="n">Real</span> <span class="n">a_time</span><span class="p">)</span>
</pre></div>
</div>
<p>and allows setting a time-dependent potential for the solver.</p>
<p>The <cite>PlasmaC</cite> field solver has a lot of supporting functionality, but essentially relies on only one critical function:
Solving for the potential.
This is done by calling a class-specific function</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">solve</span><span class="p">(</span><span class="n">MFAMRCellData</span><span class="o">&amp;</span> <span class="n">phi</span><span class="p">,</span> <span class="k">const</span> <span class="n">MFAMRCellData</span><span class="o">&amp;</span> <span class="n">rho</span><span class="p">,</span> <span class="k">const</span> <span class="n">EBAMRIVData</span><span class="o">&amp;</span> <span class="n">sigma</span><span class="p">);</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">phi</span></code> is the resulting potential that was computing with the space charge density <code class="docutils literal notranslate"><span class="pre">rho</span></code> and surface charge density <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
<p>Currently, only one field solver is implemented and this solver uses a geometric multigrid method for solving for the potential.
The solver supports three phases: electrodes, gas, and dielectric.</p>
</div>
<div class="section" id="boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>Domain boundary conditions for the solver must be set by the user through an input script, whereas the boundary conditions on internal surfaces are Dirichlet by default.
Note that on multifluid-boundaries the Dirichlet boundary condition is enforced by the conventional matching boundary condition that follows from Gauss` law.</p>
</div>
<div class="section" id="tuning-multigrid-performance">
<h2>Tuning multigrid performance<a class="headerlink" href="#tuning-multigrid-performance" title="Permalink to this headline">¶</a></h2>
<p>The Poisson equation is currently solved with a geometric multigrid method (GMG).
Various switches are enabled that adjust the performance of GMG, and these are listed below</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ====================================================================================================</span>
<span class="c1"># POISSON_MULTIFLUID_GMG_GMG CLASS OPTIONS (MULTIFLUID GMG SOLVER SETTINGS)</span>
<span class="c1"># ====================================================================================================</span>
poisson_multifluid_gmg.bc_x_low  <span class="o">=</span> neumann           <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.bc_x_high <span class="o">=</span> neumann           <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.bc_y_low  <span class="o">=</span> dirichlet_ground  <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.bc_y_high <span class="o">=</span> dirichlet_live    <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.bc_z_low  <span class="o">=</span> neumann           <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.bc_z_high <span class="o">=</span> neumann           <span class="c1"># BC type. &quot;neumann&quot;, &quot;dirichlet_ground&quot;, &quot;dirichlet_live&quot;</span>
poisson_multifluid_gmg.plt_vars  <span class="o">=</span> phi rho E res     <span class="c1"># Plot variables. Possible vars are &#39;phi&#39;, &#39;rho&#39;, &#39;E&#39;, &#39;res&#39;</span>

poisson_multifluid_gmg.auto_tune         <span class="o">=</span> <span class="nb">false</span>     <span class="c1"># Do some auto-tuning</span>
poisson_multifluid_gmg.gmg_verbosity     <span class="o">=</span> -1        <span class="c1"># GMG verbosity</span>
poisson_multifluid_gmg.gmg_pre_smooth    <span class="o">=</span> <span class="m">12</span>        <span class="c1"># Number of relaxations in downsweep</span>
poisson_multifluid_gmg.gmg_post_smooth   <span class="o">=</span> <span class="m">12</span>        <span class="c1"># Number of relaxations in upsweep</span>
poisson_multifluid_gmg.gmg_bott_smooth   <span class="o">=</span> <span class="m">12</span>        <span class="c1"># NUmber of relaxations before dropping to bottom solver</span>
poisson_multifluid_gmg.gmg_min_iter      <span class="o">=</span> <span class="m">5</span>         <span class="c1"># Minimum number of iterations</span>
poisson_multifluid_gmg.gmg_max_iter      <span class="o">=</span> <span class="m">32</span>        <span class="c1"># Maximum number of iterations</span>
poisson_multifluid_gmg.gmg_tolerance     <span class="o">=</span> <span class="m">1</span>.E-10    <span class="c1"># Residue tolerance</span>
poisson_multifluid_gmg.gmg_hang          <span class="o">=</span> <span class="m">0</span>.2       <span class="c1"># Solver hang</span>
poisson_multifluid_gmg.gmg_bottom_drop   <span class="o">=</span> <span class="m">4</span>         <span class="c1"># Bottom drop</span>
poisson_multifluid_gmg.gmg_bc_order      <span class="o">=</span> <span class="m">2</span>         <span class="c1"># Boundary condition order for multigrid</span>
poisson_multifluid_gmg.gmg_bottom_solver <span class="o">=</span> bicgstab  <span class="c1"># Bottom solver type. &#39;simple&#39;, &#39;bicgstab&#39;, or &#39;gmres&#39;</span>
poisson_multifluid_gmg.gmg_bottom_relax  <span class="o">=</span> <span class="m">32</span>        <span class="c1"># Number of relaxations in bottom solve (&#39;simple&#39; solver only)</span>
poisson_multifluid_gmg.gmg_cycle         <span class="o">=</span> vcycle    <span class="c1"># Cycle type. Only &#39;vcycle&#39; supported for now</span>
poisson_multifluid_gmg.gmg_relax_type    <span class="o">=</span> gsrb      <span class="c1"># Relaxation type. &#39;jacobi&#39;, &#39;gauss_seidel&#39;, or &#39;gsrb&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="adjusting-output">
<h2>Adjusting output<a class="headerlink" href="#adjusting-output" title="Permalink to this headline">¶</a></h2>
<p>The user may plot the potential, the space charge, the electric, and the GMG residue as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poisson_multifluid_gmg.plt_vars  <span class="o">=</span> phi rho E res     <span class="c1"># Plot variables. Possible vars are &#39;phi&#39;, &#39;rho&#39;, &#39;E&#39;, &#39;res&#39;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="RTE.html" class="btn btn-neutral float-right" title="Radiative transfer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CDR.html" class="btn btn-neutral float-left" title="Convection-Diffusion-Reaction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Robert Marskar

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>